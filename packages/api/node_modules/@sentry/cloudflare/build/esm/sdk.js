import { _nullishCoalesce } from '@sentry/core';
import { dedupeIntegration, inboundFiltersIntegration, functionToStringIntegration, linkedErrorsIntegration, requestDataIntegration, stackParserFromStackParserOptions, getIntegrationsToSetup, initAndBind } from '@sentry/core';
import { CloudflareClient } from './client.js';
import { fetchIntegration } from './integrations/fetch.js';
import { makeCloudflareTransport } from './transport.js';
import { defaultStackParser } from './vendor/stacktrace.js';

/** Get the default integrations for the Cloudflare SDK. */
function getDefaultIntegrations(options) {
  const sendDefaultPii = _nullishCoalesce(options.sendDefaultPii, () => ( false));
  return [
    dedupeIntegration(),
    inboundFiltersIntegration(),
    functionToStringIntegration(),
    linkedErrorsIntegration(),
    fetchIntegration(),
    requestDataIntegration(sendDefaultPii ? undefined : { include: { cookies: false } }),
  ];
}

/**
 * Initializes the cloudflare SDK.
 */
function init(options) {
  if (options.defaultIntegrations === undefined) {
    options.defaultIntegrations = getDefaultIntegrations(options);
  }

  const clientOptions = {
    ...options,
    stackParser: stackParserFromStackParserOptions(options.stackParser || defaultStackParser),
    integrations: getIntegrationsToSetup(options),
    transport: options.transport || makeCloudflareTransport,
  };

  return initAndBind(CloudflareClient, clientOptions) ;
}

export { getDefaultIntegrations, init };
//# sourceMappingURL=sdk.js.map
